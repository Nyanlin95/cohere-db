# Database Context for AI Assistants

> AUTO-GENERATED by cohere. Last updated: {{timestamp}}

## Quick Reference

| Table | Primary Key | Foreign Keys | Key Columns |
|-------|-------------|--------------|-------------|
{{#each tables}}
| [{{name}}](#{{name}}) | {{primaryKey}} | {{foreignKeyCount}} | {{keyColumns}} |
{{/each}}

## Schema Diagram

```
{{schemaDiagram}}
```

## Table Details

{{#each tables}}
### {{name}}

**Description:** {{description}}

**Columns:**
```
{{columnList}}
```

**Relationships:**
{{#if relationships}}
{{relationships}}
{{else}}
- No foreign keys
{{/if}}

**Usage Pattern:** {{usagePattern}}

{{/each}}

## Query Patterns

### Create (Insert)

```sql
-- Insert a single record
INSERT INTO {{table}} ({{columns}}) VALUES ({{values}});

-- Bulk insert
INSERT INTO {{table}} ({{columns}}) VALUES
{{#each examples}}
({{values}}), -- {{description}}
{{/each}};
```

### Read (Select)

```sql
-- Get by ID
SELECT * FROM {{table}} WHERE id = $1;

-- Get with relationships
SELECT * FROM {{table}}
JOIN {{relatedTable}} ON {{joinCondition}}
WHERE {{table}}.id = $1;

-- List with pagination
SELECT * FROM {{table}}
WHERE organization_id = $1
ORDER BY created_at DESC
LIMIT $2 OFFSET $3;
```

### Update

```sql
-- Update by ID
UPDATE {{table}}
SET {{setClause}}
WHERE id = $1 AND organization_id = $2;
```

### Delete

```sql
-- Soft delete (recommended)
UPDATE {{table}}
SET deleted_at = NOW()
WHERE id = $1 AND organization_id = $2;

-- Hard delete (use with caution)
DELETE FROM {{table}}
WHERE id = $1 AND organization_id = $2;
```

## Common Patterns

### Multi-Tenant Isolation

All queries MUST include organization_id:

```sql
-- ✅ Correct
SELECT * FROM users WHERE id = $1 AND organization_id = $2;

-- ❌ Wrong - Missing organization check
SELECT * FROM users WHERE id = $1;
```

### Soft Deletes

Always filter out deleted records:

```sql
-- ✅ Correct
SELECT * FROM users
WHERE organization_id = $1
AND deleted_at IS NULL;

-- ❌ Wrong - Includes deleted records
SELECT * FROM users WHERE organization_id = $1;
```

### Timestamps

Use created_at and updated_at for ordering and auditing:

```sql
SELECT * FROM {{table}}
WHERE organization_id = $1
ORDER BY created_at DESC;
```

## Type Mappings

| Database Type | TypeScript Type |
|---------------|-----------------|
{{#each typeMappings}}
| `{{dbType}}` | `{{tsType}}` |
{{/each}}

## Performance Tips

{{#each performanceTips}}
- {{.}}
{{/each}}

## Generated Files

This context was generated from:
- Schema: `{{schemaSource}}`
- Generated: `{{timestamp}}`
- Generator: `cohere v{{version}}`
